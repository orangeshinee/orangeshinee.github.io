<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="如何为基于Stack主题的Hugo博客添加照片相册功能"><title>Hugo博客相册功能实现</title>
<link rel=canonical href=https://blog.shineee.site/p/2024/04/02/hugo-gallery-photo-custom/><link rel=stylesheet href=/scss/style.min.9f95e55efaae412e2c5c1bf71338bd0bf9a03ad89376e34b04b4ff94a7f46e45.css><meta property='og:title' content="Hugo博客相册功能实现"><meta property='og:description' content="如何为基于Stack主题的Hugo博客添加照片相册功能"><meta property='og:url' content='https://blog.shineee.site/p/2024/04/02/hugo-gallery-photo-custom/'><meta property='og:site_name' content='闲谈梦落花'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Hugo'><meta property='article:tag' content='前端'><meta property='article:tag' content='JavaScript'><meta property='article:tag' content='相册'><meta property='article:published_time' content='2024-04-02T11:00:00+08:00'><meta property='article:modified_time' content='2024-04-02T11:00:00+08:00'><meta property='og:image' content='https://blog.shineee.site/p/2024/04/02/hugo-gallery-photo-custom/cover.png'><meta name=twitter:site content="@@shinelovesmile"><meta name=twitter:creator content="@@shinelovesmile"><meta name=twitter:title content="Hugo博客相册功能实现"><meta name=twitter:description content="如何为基于Stack主题的Hugo博客添加照片相册功能"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.shineee.site/p/2024/04/02/hugo-gallery-photo-custom/cover.png'><link rel="shortcut icon" href=/favicon.png><link rel=stylesheet href=https://chinese-fonts-cdn.deno.dev/packages/lywkpmydb/dist/LXGWWenKaiScreen/result.css><link rel=stylesheet href=https://chinese-fonts-cdn.deno.dev/packages/maple-mono-cn/dist/MapleMono-CN-Medium/result.css><link rel=stylesheet href=https://chinese-fonts-cdn.deno.dev/packages/maple-mono-cn/dist/MapleMono-CN-Regular/result.css></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_4717ec72003b6355.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>闲谈梦落花</a></h1><h2 class=site-description>长路漫漫离家，伴君不负韶华</h2></div></header><ol class=menu-social><li><a href=https://github.com/orangeshinee target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/shinelovesmile target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>首页</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/gallery/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>相册</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#功能需求>功能需求</a></li><li><a href=#实现思路>实现思路</a></li><li><a href=#具体实现>具体实现</a><ol><li><a href=#1-创建相册入口页面>1. 创建相册入口页面</a></li><li><a href=#2-创建相册数据文件>2. 创建相册数据文件</a></li><li><a href=#3-创建相册列表布局>3. 创建相册列表布局</a></li><li><a href=#4-创建单个相册页面>4. 创建单个相册页面</a></li><li><a href=#5-创建照片展示布局>5. 创建照片展示布局</a></li><li><a href=#6-创建照片目录结构>6. 创建照片目录结构</a></li><li><a href=#7-更新菜单配置>7. 更新菜单配置</a></li></ol></li><li><a href=#优化与改进>优化与改进</a><ol><li><a href=#相对路径问题>相对路径问题</a></li><li><a href=#照片数量计算>照片数量计算</a></li><li><a href=#大小写敏感的图片格式>大小写敏感的图片格式</a></li></ol></li><li><a href=#最终效果>最终效果</a></li><li><a href=#总结>总结</a></li><li><a href=#功能优化与调整记录>功能优化与调整记录</a><ol><li><a href=#1-照片排序优化>1. 照片排序优化</a></li><li><a href=#2-移除照片标题和时间显示>2. 移除照片标题和时间显示</a></li><li><a href=#3-相册配置的灵活性>3. 相册配置的灵活性</a></li><li><a href=#4-文件命名建议>4. 文件命名建议</a></li><li><a href=#5-照片加载优化>5. 照片加载优化</a></li></ol></li><li><a href=#最终配置参考>最终配置参考</a><ol><li><a href=#相册数据配置datagalleryyaml>相册数据配置（data/gallery.yaml）：</a></li><li><a href=#照片显示模板layouts_defaultphotoshtml核心部分>照片显示模板（layouts/_default/photos.html）核心部分：</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/2024/04/02/hugo-gallery-photo-custom/><img src=/p/2024/04/02/hugo-gallery-photo-custom/cover_hu_bc7dbbef1eb9a9f8.png srcset="/p/2024/04/02/hugo-gallery-photo-custom/cover_hu_bc7dbbef1eb9a9f8.png 800w, /p/2024/04/02/hugo-gallery-photo-custom/cover_hu_244a8b8a1d414cc2.png 1600w" width=800 height=340 loading=lazy alt="Featured image of post Hugo博客相册功能实现"></a></div><div class=article-details><header class=article-category><a href=/categories/%E5%8D%9A%E5%AE%A2/>博客</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/2024/04/02/hugo-gallery-photo-custom/>Hugo博客相册功能实现</a></h2><h3 class=article-subtitle>如何为基于Stack主题的Hugo博客添加照片相册功能</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2024-04-02</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 7 分钟</time></div></footer></div></header><section class=article-content><h2 id=前言>前言</h2><p>在使用Hugo搭建个人博客时，除了写文章，我还希望能有一个专门展示照片的地方。本文记录了为基于Stack主题的Hugo博客添加相册功能的完整实现过程，希望对有类似需求的朋友提供参考。</p><h2 id=功能需求>功能需求</h2><p>我对相册功能的需求很简单：</p><ol><li>首页展示不同的相册集合，每个相册有封面图和描述</li><li>点击相册进入详情页，展示该相册下的所有照片</li><li>照片支持懒加载，提高页面加载速度</li><li>支持照片点击查看大图和轻松浏览</li></ol><h2 id=实现思路>实现思路</h2><p>相册功能主要由以下几个部分组成：</p><ol><li><strong>相册数据配置</strong>：使用YAML数据文件存储相册信息</li><li><strong>相册列表页面</strong>：展示所有相册，使用CSS Grid布局</li><li><strong>单个相册页面</strong>：展示特定相册中的照片，使用瀑布流布局</li><li><strong>静态资源</strong>：照片文件按相册分类存储</li></ol><h2 id=具体实现>具体实现</h2><h3 id=1-创建相册入口页面>1. 创建相册入口页面</h3><p>首先，在<code>content/page/gallery/index.md</code>中创建相册入口页面：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>title: &#34;相册&#34;
</span></span><span class=line><span class=cl>description: &#34;我的照片集合&#34;
</span></span><span class=line><span class=cl>slug: &#34;gallery&#34;
</span></span><span class=line><span class=cl>layout: &#34;gallery&#34;
</span></span><span class=line><span class=cl>menu:
</span></span><span class=line><span class=cl>    main:
</span></span><span class=line><span class=cl>        weight: 4
</span></span><span class=line><span class=cl>        params: 
</span></span><span class=line><span class=cl>            icon: image
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>这里收集了我的一些照片回忆，记录生活的美好瞬间。
</span></span></code></pre></td></tr></table></div></div><h3 id=2-创建相册数据文件>2. 创建相册数据文件</h3><p>在<code>data/gallery.yaml</code>中定义所有相册信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;今天的云&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;clouds&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;记录下每天不同的云朵形状&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/clouds/cover.jpg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;行东京&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;tokyo&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;漫步在东京的街头巷尾&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/tokyo/cover.jpg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;今天吃咩&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;food&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;记录美食与生活&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/food/cover.jpg&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>这里只需要配置相册的基本信息和封面图，实际照片将从对应文件夹中自动读取。</p><h3 id=3-创建相册列表布局>3. 创建相册列表布局</h3><p>在<code>layouts/_default/gallery.html</code>中实现相册列表页面：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ define &#34;main&#34; }}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>header</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;page-header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{{ .Title }}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ with .Description }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;page-description&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {{ . }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ end }}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>section</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-collections&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ range $idx, $album := .Site.Data.gallery }}
</span></span><span class=line><span class=cl>        {{ $albumPath := printf &#34;./static/photos/%s&#34; $album.slug }}
</span></span><span class=line><span class=cl>        {{ $photoCount := 0 }}
</span></span><span class=line><span class=cl>        {{ range readDir $albumPath }}
</span></span><span class=line><span class=cl>            {{ if findRE &#34;(?i)\\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$&#34; .Name }}
</span></span><span class=line><span class=cl>                {{ if ne .Name &#34;cover.jpg&#34; }}
</span></span><span class=line><span class=cl>                    {{ $photoCount = add $photoCount 1 }}
</span></span><span class=line><span class=cl>                {{ end }}
</span></span><span class=line><span class=cl>            {{ end }}
</span></span><span class=line><span class=cl>        {{ end }}
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;album-card&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/gallery/{{ $album.slug }}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;album-cover&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ $album.cover }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ $album.title }}的封面&#34;</span> <span class=na>loading</span><span class=o>=</span><span class=s>&#34;lazy&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;album-info&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>{{ $album.title }}<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>{{ $album.description }}<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-count&#34;</span><span class=p>&gt;</span>{{ $photoCount }} 张照片<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ end }}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{ end }}
</span></span></code></pre></td></tr></table></div></div><p>这个模板使用CSS Grid创建一个响应式的相册卡片网格，并自动计算每个相册中的照片数量。</p><h3 id=4-创建单个相册页面>4. 创建单个相册页面</h3><p>为每个相册创建对应的内容页面。例如，在<code>content/gallery/clouds/index.md</code>中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>title: &#34;今天的云&#34;
</span></span><span class=line><span class=cl>description: &#34;记录下每天不同的云朵形状&#34;
</span></span><span class=line><span class=cl>date: 2024-04-02T10:00:00+08:00
</span></span><span class=line><span class=cl>albumSlug: &#34;clouds&#34;
</span></span><span class=line><span class=cl>layout: &#34;photos&#34;
</span></span><span class=line><span class=cl>---
</span></span></code></pre></td></tr></table></div></div><p>注意<code>layout</code>使用了<code>photos</code>，这个布局负责展示相册中的所有照片。</p><h3 id=5-创建照片展示布局>5. 创建照片展示布局</h3><p>在<code>layouts/_default/photos.html</code>中实现照片展示页面：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ define &#34;main&#34; }}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-header&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{{ .Title }}<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ with .Description }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-description&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {{ . }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ end }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;album-nav&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/gallery/&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;back-to-albums&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>svg</span> <span class=na>xmlns</span><span class=o>=</span><span class=s>&#34;http://www.w3.org/2000/svg&#34;</span> <span class=na>width</span><span class=o>=</span><span class=s>&#34;24&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;24&#34;</span> <span class=na>viewBox</span><span class=o>=</span><span class=s>&#34;0 0 24 24&#34;</span> <span class=na>fill</span><span class=o>=</span><span class=s>&#34;none&#34;</span> <span class=na>stroke</span><span class=o>=</span><span class=s>&#34;currentColor&#34;</span> <span class=na>stroke-width</span><span class=o>=</span><span class=s>&#34;2&#34;</span> <span class=na>stroke-linecap</span><span class=o>=</span><span class=s>&#34;round&#34;</span> <span class=na>stroke-linejoin</span><span class=o>=</span><span class=s>&#34;round&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>path</span> <span class=na>d</span><span class=o>=</span><span class=s>&#34;M15 18l-6-6 6-6&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>path</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>svg</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            返回相册列表
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photos page&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  {{ $albumSlug := .Params.albumSlug }}
</span></span><span class=line><span class=cl>  {{ $albumPath := printf &#34;./static/photos/%s&#34; $albumSlug }}
</span></span><span class=line><span class=cl>  {{ range (sort (readDir $albumPath) &#34;Name&#34; &#34;asc&#34;)}}
</span></span><span class=line><span class=cl>    {{ if ( .Name | findRE &#34;(?i)\\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$&#34;) }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photo&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>img</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-img&#34;</span> <span class=na>loading</span><span class=o>=</span><span class=s>&#39;lazy&#39;</span> <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/photos/{{ $albumSlug }}/{{ .Name }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ .Name }}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ end }}
</span></span><span class=line><span class=cl>  {{ end }}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{ end }}
</span></span></code></pre></td></tr></table></div></div><p>这个布局使用瀑布流展示照片，并支持照片懒加载和点击查看大图。</p><h3 id=6-创建照片目录结构>6. 创建照片目录结构</h3><p>照片文件按照以下结构组织：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>static/
</span></span><span class=line><span class=cl>  photos/
</span></span><span class=line><span class=cl>    clouds/
</span></span><span class=line><span class=cl>      cover.jpg  # 相册封面
</span></span><span class=line><span class=cl>      cloud1.jpg  # 照片1
</span></span><span class=line><span class=cl>      cloud2.jpg  # 照片2
</span></span><span class=line><span class=cl>      ...
</span></span><span class=line><span class=cl>    tokyo/
</span></span><span class=line><span class=cl>      cover.jpg
</span></span><span class=line><span class=cl>      tokyo1.jpg
</span></span><span class=line><span class=cl>      ...
</span></span><span class=line><span class=cl>    food/
</span></span><span class=line><span class=cl>      cover.jpg
</span></span><span class=line><span class=cl>      food1.jpg
</span></span><span class=line><span class=cl>      ...
</span></span></code></pre></td></tr></table></div></div><p>每个相册都有自己的文件夹，封面图命名为<code>cover.jpg</code>，也可以根据你的需求自定义为其他照片，在<code>gallery.yaml</code>中修改即可。</p><h3 id=7-更新菜单配置>7. 更新菜单配置</h3><p>在<code>config/_default/menu.toml</code>中添加相册菜单项：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[[</span><span class=nx>main</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>identifier</span> <span class=p>=</span> <span class=s2>&#34;gallery&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;相册&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>url</span> <span class=p>=</span> <span class=s2>&#34;/gallery/&#34;</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>main</span><span class=p>.</span><span class=nx>params</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>icon</span> <span class=p>=</span> <span class=s2>&#34;image&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=优化与改进>优化与改进</h2><p>在实现过程中，我遇到了一些问题并进行了优化：</p><h3 id=相对路径问题>相对路径问题</h3><p>最初使用<code>{{ $.Site.BaseURL }}</code>生成链接，但在局域网访问时会出现问题。改为使用相对路径<code>/gallery/</code>和<code>/photos/</code>解决了这个问题。</p><h3 id=照片数量计算>照片数量计算</h3><p>最初在YAML数据文件中定义每张照片，后改为直接读取文件夹中的照片：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>{{</span> <span class=err>$</span><span class=nx>albumPath</span> <span class=o>:=</span> <span class=nx>printf</span> <span class=s>&#34;./static/photos/%s&#34;</span> <span class=err>$</span><span class=nx>album</span><span class=p>.</span><span class=nx>slug</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=err>$</span><span class=nx>photoCount</span> <span class=o>:=</span> <span class=mi>0</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=k>range</span> <span class=nx>readDir</span> <span class=err>$</span><span class=nx>albumPath</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span> <span class=k>if</span> <span class=nx>findRE</span> <span class=s>&#34;(?i)\\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$&#34;</span> <span class=p>.</span><span class=nx>Name</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>        <span class=p>{{</span> <span class=k>if</span> <span class=nx>ne</span> <span class=p>.</span><span class=nx>Name</span> <span class=s>&#34;cover.jpg&#34;</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>            <span class=p>{{</span> <span class=err>$</span><span class=nx>photoCount</span> <span class=p>=</span> <span class=nx>add</span> <span class=err>$</span><span class=nx>photoCount</span> <span class=mi>1</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>        <span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=大小写敏感的图片格式>大小写敏感的图片格式</h3><p>添加<code>(?i)</code>标志使正则表达式大小写不敏感，支持<code>.JPG</code>和<code>.jpg</code>等不同大小写的文件扩展名：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>{{</span> <span class=k>if</span> <span class=p>(</span> <span class=p>.</span><span class=nx>Name</span> <span class=p>|</span> <span class=nx>findRE</span> <span class=s>&#34;(?i)\\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$&#34;</span><span class=p>)</span> <span class=p>}}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=最终效果>最终效果</h2><p><img src=https://cdn.jsdelivr.net/gh/your-username/your-repo/gallery-home.jpg loading=lazy alt=相册首页></p><p>实现了一个简洁美观的相册功能，主要特点：</p><ol><li>响应式设计，适应不同设备</li><li>图片懒加载，提高加载速度</li><li>照片瀑布流布局，充分利用屏幕空间</li><li>支持点击查看大图和轻松浏览</li><li>使用文件系统组织照片，便于管理</li></ol><h2 id=总结>总结</h2><p>通过自定义布局和数据文件，在Hugo博客中实现了功能完善的相册系统。整个实现过程展示了Hugo强大的模板功能和灵活性，不需要额外的插件或数据库支持，就能打造一个美观实用的相册功能。</p><p>希望这篇文章对想要在Hugo博客中添加相册功能的朋友有所帮助！如有问题或改进建议，欢迎在评论区交流。</p><h2 id=功能优化与调整记录>功能优化与调整记录</h2><p>在实现基本功能后，我根据实际使用情况对相册功能进行了一些优化和调整。以下是优化过程中的一些关键修改：</p><h3 id=1-照片排序优化>1. 照片排序优化</h3><p>最初实现中，相册中的照片是按照文件名降序（&ldquo;desc&rdquo;）排列的。但在实际使用过程中，我发现按照文件名升序（&ldquo;asc&rdquo;）排列更符合浏览习惯，特别是当照片按照时间顺序命名时。</p><p>修改前：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ range (sort (readDir $albumPath) &#34;Name&#34; &#34;desc&#34;)}}
</span></span></code></pre></td></tr></table></div></div><p>修改后：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{ range (sort (readDir $albumPath) &#34;Name&#34; &#34;asc&#34;)}}
</span></span></code></pre></td></tr></table></div></div><p>这样，照片就会按照文件名从小到大的顺序排列，通常对应时间的先后顺序，提供更好的浏览体验。</p><h3 id=2-移除照片标题和时间显示>2. 移除照片标题和时间显示</h3><p>在早期版本中，我曾实现了从文件名中提取并显示照片标题和拍摄时间的功能：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photo&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>img</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-img&#34;</span> <span class=na>loading</span><span class=o>=</span><span class=s>&#39;lazy&#39;</span> <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/photos/{{ $albumSlug }}/{{ .Name }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ .Name }}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-title&#34;</span><span class=p>&gt;</span>{{ .Name | replaceRE &#34;^[0-9 -]+(.*)[.].*&#34; &#34;$1&#34;}}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-time&#34;</span><span class=p>&gt;</span>{{ .Name | replaceRE &#34;^([0-9-]+).*[.].*&#34; &#34;$1&#34; }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>这要求我按照特定格式命名照片文件，如"2024-04-02-樱花.jpg"，其中"2024-04-02"会被提取为时间，&ldquo;樱花"会被提取为标题。</p><p>但在实际使用中，我发现这种命名方式有些繁琐，而且页面上显示这些信息会让相册页面显得过于拥挤。因此，我移除了这些显示元素，回归到更简洁的界面设计：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photo&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>img</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-img&#34;</span> <span class=na>loading</span><span class=o>=</span><span class=s>&#39;lazy&#39;</span> <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/photos/{{ $albumSlug }}/{{ .Name }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ .Name }}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-相册配置的灵活性>3. 相册配置的灵活性</h3><p>在<code>data/gallery.yaml</code>中，我为相册配置增加了更多灵活性。可以自定义封面图路径，不一定非要使用相册文件夹中的"cover.jpg&rdquo;：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;今天的云&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;clouds&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;记录下每天不同的云朵形状&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/clouds/best-cloud.jpg&#34;</span><span class=w>  </span><span class=c># 可以指定任意图片作为封面</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=4-文件命名建议>4. 文件命名建议</h3><p>经过实践，我发现以下文件命名约定效果较好：</p><ul><li>相册文件夹：使用简短的英文单词，如"clouds"、&ldquo;tokyo&rdquo;</li><li>照片文件：使用日期前缀命名，如"2024-04-02-1.jpg"、&ldquo;2024-04-02-2.jpg&rdquo;</li></ul><p>这种命名方式既保持了文件的良好组织，又便于按时间顺序浏览照片。</p><h3 id=5-照片加载优化>5. 照片加载优化</h3><p>为了进一步优化照片加载性能，我在img标签中增加了更多的属性：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-img&#34;</span> 
</span></span><span class=line><span class=cl>     <span class=na>loading</span><span class=o>=</span><span class=s>&#34;lazy&#34;</span> 
</span></span><span class=line><span class=cl>     <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span> 
</span></span><span class=line><span class=cl>     <span class=na>src</span><span class=o>=</span><span class=s>&#34;/photos/{{ $albumSlug }}/{{ .Name }}&#34;</span> 
</span></span><span class=line><span class=cl>     <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ .Name }}&#34;</span> <span class=p>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><code>loading="lazy"</code>确保了图片只有在即将进入视口时才会加载，而<code>decoding="async"</code>让浏览器可以异步解码图片，不阻塞主线程，提高页面响应速度。</p><h2 id=最终配置参考>最终配置参考</h2><p>以下是最终使用的相册配置和模板代码，供参考：</p><h3 id=相册数据配置datagalleryyaml>相册数据配置（data/gallery.yaml）：</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;今天的云&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;clouds&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;记录下每天不同的云朵形状&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/clouds/cover.jpg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;行东京&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;tokyo&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;漫步在东京的街头巷尾&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/tokyo/cover.jpg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;今天吃咩&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;food&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;记录美食与生活&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cover</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photos/food/cover.jpg&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=照片显示模板layouts_defaultphotoshtml核心部分>照片显示模板（layouts/_default/photos.html）核心部分：</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photos page&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  {{ $albumSlug := .Params.albumSlug }}
</span></span><span class=line><span class=cl>  {{ $albumPath := printf &#34;./static/photos/%s&#34; $albumSlug }}
</span></span><span class=line><span class=cl>  {{ range (sort (readDir $albumPath) &#34;Name&#34; &#34;asc&#34;)}}
</span></span><span class=line><span class=cl>    {{ if ( .Name | findRE &#34;(?i)\\.(gif|jpg|jpeg|tiff|png|bmp|webp|avif|jxl)$&#34;) }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;gallery-photo&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>img</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo-img&#34;</span> <span class=na>loading</span><span class=o>=</span><span class=s>&#39;lazy&#39;</span> <span class=na>decoding</span><span class=o>=</span><span class=s>&#34;async&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/photos/{{ $albumSlug }}/{{ .Name }}&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;{{ .Name }}&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    {{ end }}
</span></span><span class=line><span class=cl>  {{ end }}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>通过这些优化和调整，相册功能变得更加简洁、高效，提供了更好的用户体验。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/hugo/>Hugo</a>
<a href=/tags/%E5%89%8D%E7%AB%AF/>前端</a>
<a href=/tags/javascript/>JavaScript</a>
<a href=/tags/%E7%9B%B8%E5%86%8C/>相册</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/2022/05/04/hexo-hext-update/><div class=article-details><h2 class=article-title>Hexo升级之旅</h2></div></a></article><article><a href=/p/2021/08/30/hexo-github-action/><div class=article-details><h2 class=article-title>Hexo-GitHub Actions 自动部署</h2></div></a></article><article><a href=/p/2018/12/16/custom-album/><div class=article-details><h2 class=article-title>Hexo添加自定义相册</h2></div></a></article><article><a href=/p/2018/09/15/hexo-next-customization/><div class=article-details><h2 class=article-title>Hexo网站主题美化记录</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=orangeshinee/BlogComments issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2016 -
2025 闲谈梦落花</section><section class=powerby>Made By ❤️ishineee_<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>